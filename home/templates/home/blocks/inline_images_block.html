{% load i18n wagtailimages_tags %}
<section class="inline-images-block block">
<div class="container">
    <div class="container-narrow">
        <div class="row">
        {% for item in self.inline_images %}
            <div class="col-md-{{self.columns}} inline-images-block-col">
                <figure>
                {% if item.internal_link %}
                <a href="{{ item.internal_link.url }}">
                {% endif %}
                    <div class="img-container">{% image item.image width-900 class="img-responsive" %}</div>
                    <figcaption class="inline-images-text">{{ item.link_text }}</figcaption>
                {% if item.internal_link %}
                </a>
                {% endif %}
                </figure>
            </div>
            {% if self.columns == "4" %}
                {% if forloop.counter|divisibleby:3 %}
                </div>
                <div class="row">
                {% endif %}
            {% elif self.columns == "6" %}
                {% if forloop.counter|divisibleby:2 %}
                </div>
                <div class="row">
                {% endif %}
            {% endif %}
        {% endfor %}
    </div>
</div>
</section>
