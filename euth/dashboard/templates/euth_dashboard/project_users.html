{% extends "euth_dashboard/base_organisation.html" %}
{% load widget_tweaks i18n %}

{% block dashboard_content %}
<h1 class="black-divider dashboard-title">{% trans 'Manage user of ' %}{{ project.name }}</h1>
            <form method="POST">

{% if not project.is_public %}
    <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" class="active"><a href="#members" aria-controls="members" role="tab" data-toggle="tab">Members</a></li>
        <li role="presentation"><a href="#moderators" aria-controls="moderators" role="tab" data-toggle="tab">Moderators</a></li>
    </ul>

    <div class="tab-content">
        <div role="tabpanel" class="tab-pane active" id="members">

{% endif %}
            {{ form.mailinvites.as_p }}
            <h2 class="sans-serif">Members</h2>
                {% csrf_token %}
                <div class="form-group">
                    <label for="{{ form.moderators.user.id_for_label }}">{{ form.moderators.user.label }}</label>
                    <p class='form-help-text'>{{ form.moderators.user.help_text }}</p>
                    {{ form.moderators.user|add_class:'form-control' }}
                    {{ form.moderators.user.errors }}
                </div>
                {{ form.moderators.media }}
                <button type="submit"></button>
    {{ project.moderators.all }}
{% if not project.is_public %}
        </div>
        <div role="tabpanel" class="tab-pane" id="moderators">
            <h2 class="sans-serif">Moderators</h2>
        </div>
    </div>
{% endif %}
{{ form.requests.management_form }}
{{ form.invites.management_form }}
{{ form.users.management_form }}

<p>
    <a href="{% url 'dashboard-project-invite' organisation_slug=view.organisation.slug slug=project.slug %}" class="btn btn-primary">{% trans 'Invite users' %}</a>
</p>
{% if form.requests.forms or form.invites.forms or form.users.forms %}
    {% csrf_token %}
    <div class="table-list">
        <div class="table-list-head">
            <div class="row">
                <div class="col-sm-4">Name</div>
                <div class="col-sm-5">Email</div>
                <div class="col-sm-3">Edit</div>
            </div>
        </div>
        <div class="table-list-body">
            {% for form in form.requests.forms %}
                {{ form.id }}
                <div class="table-list-row tile-list row">
                    <div class="col-sm-4"><a href="{% url 'profile' form.instance.creator.username %}" class="text-muted">{{ form.instance.creator.username }}</a></div>
                    <div class="col-sm-5"><strong>{{ form.instance.creator.email }}</strong></div>
                    <div class="col-sm-3">
                        {% for radio in form.action %}
                        <div class="radio-action">
                            {{ radio.tag }}
                            <label for="{{ radio.id_for_label }}" class="{{ radio.choice_label|lower }} radio-label">
                                <span class="radio-text sr-only">{{ radio.choice_label }}</span>
                            </label>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            {% endfor %}
            {% for form in form.invites.forms %}
                {{ form.id }}
                <div class="table-list-row tile-list row">
                    <div class="col-sm-4"></div>
                    <div class="col-sm-5"><strong>{{ form.instance.email }}</strong></div>
                    <div class="col-sm-3">
                        <div class="radio-action">
                            {{ form.delete }}
                            <label for="{{ form.delete.id_for_label }}" class="{{ form.delete.label|lower }} radio-label">
                                <span class="radio-text sr-only">{{ form.delete.label }}</span>
                            </label>
                        </div>
                    </div>
                </div>
            {% endfor %}
            {% for form in form.users.forms %}
                {{ form.id }}
                <div class="table-list-row tile-list row">
                    <div class="col-sm-4"><a href="{% url 'profile' form.instance.username %}" class="text-muted">{{ form.instance.username}}</a></div>
                    <div class="col-sm-5"><strong>{{ form.instance.email }}</strong></div>
                    <div class="col-sm-3">
                        <div class="radio-action">
                            {{ form.delete }}
                            <label for="{{ form.delete.id_for_label }}" class="{{ form.delete.label|lower }} radio-label">
                                <span class="radio-text sr-only">{{ form.delete.label }}</span>
                            </label>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
    <input type="submit" class="btn btn-primary" value="{% trans 'Submit' %}">
</form>
{% else %}
<p>There are no invites, requests or users in this project yet.</p>
{% endif %}
{% endblock %}
